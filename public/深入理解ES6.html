<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html;">
    <meta name="viewport"
          content="initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="format-detection" content="email=no"/>
    <meta name="format-detection" content="address=no;">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <title>深入理解ES6</title>
</head>
<body>
<script type="text/javascript">


    // 2018年3月28日
    /*function test(a=1) {
        console.log(a);
    }
    test(0)
    test(null)
    test(undefined)
    test(false)
    test('')
    //要么不传，要么传undefined*/

    /*function demo(a=1,b=2,c=3) {
        console.log(this);
        console.log(arguments);
    }
    new demo (7, 3)*/

    /*console.log({
      fn:function () {},
      afn:()=>{},
      gfn:function *f(){}
    });*/

    /**总结
     *  *f是什么 generate函数
     *
     */
    // [[FunctionLocation]]
    // [[constructor]]
    // [[call]]
    // [[Scope]]
    // [[prototype]]


    // 箭头函数afn有call,scope，没有super,argument


    // 动态相关： this/arguments/super/new target


    /*function fn(a,b) {

    }*/


    /*function fn1() {
      this.test = 'fn1'
      console.log(this);
      function fn2() {
        this.test = 'fn2'
        console.log(this);
        let fn3 =()=>{
          this.test = 'fn3'
          console.log(this);
        }
        fn3()
      }
      fn2()
    }
    fn1()
    console.log(test);*/


    /*let fn =(a)=>{
      console.log(1);
      console.log(this);
      console.log(arguments);
    }
    fn(1)*/
    /*function fn(a) {
      console.log(1);
      console.log(this);
      console.log(arguments);
    }
    fn(1)*/

    // call调用

    /*function fn1() {
      console.log(arguments);
      arguments[0].nickname = 'fn1'
      let fn2 = function () {
        console.log(arguments);
        arguments[0].nickname = 'fn2'
      }
      fn2()
    }
    let obj = {}
    fn1(obj)*/

    /*JS字面量
    Number, String , Object, Array, Regex
    *
    *
    * */
    /*let obj = {
      1:2
    }
    let arr = [1,2]
    obj[arr] = 1111
    obj['7'+'8'] = 78
    console.log(obj);*/
    // console.log(obj.1);


    /*console.log(Object.getPrototypeOf({}));//Object.prototype
    console.log(Object.getPrototypeOf(Object));//Function.prototype
    console.log();
    Object.setPrototypeOf = function (obj) {
      return obj.__proto__
    }

      Object.getPrototypeOf = function (obj, value) {
        obj.__proto__ = value
      }*/

    /*Object.prototype.fun = function(){
      return 'test'
    }

    let a = 1
    let b = {}
    let c = []
  console.log(a.fun());
  console.log(b.fun());
  console.log(c.fun());*/


    /*function fun() {
      console.log(arguments);
      console.log(arguments.__proto__);//Object.prototype
      console.log(arguments.__proto__ === Object.prototype);//true
    }
    fun()*/



    // extend ,assign
    /**extend浅拷贝
     * @param destination
     * @param source
     * @returns {*}
     * 参考：https://www.jianshu.com/p/04b1d88dabf2
     */
    /*var extend = function (destination, source) {
      for(var key in source){
        destination[key] = source[key]
      }
      return destination
    }
    let newObj = extend({a:1, d:4}, {a:2, b:2, c:3})
    console.log(newObj);

    /!**
     * Object.assign
     * 参考：https://blog.csdn.net/DeepLies/article/details/52915143
     * @type {{a: number}}
     *!/
    var obj1 = {a:1}
    var obj2 = {a:2, b:2}
    var obj3 = {a:3, b:4, c:5}
    Object.assign(obj1,obj2,obj3)
    console.log(obj1);*/


    /**
     * 总结：
     * 作用域：全局，函数，块级，闭包；
     * 全局
     *
     * 块级作用域：let,const
     */

    /*var d = 4
    function fun1() {
      var a = 1
      function fun2(b) {
        var c = 3
        {
          let t = 10
          console.log(a,b,c,d);
        }
      }
      fun2()
    }
    fun1()*/


    /**
     * TDZ, let/coast/
     */

    //繁引号
    //块级作用域

  //${表达式}

    /**
     *
     */
    // fn函数和箭头函数区别：
  // 箭头函数无this,无argument,无constructor


  // 函数类别：fn, 箭头函数， function *(){} async function

    /*等价
  obj.__proto__
  obj.getPrototypeOf*/

    // console.log(Number.prototype);
    // console.log(typeof 123);
    // console.log(typeof Array);
    // console.log(typeof Function);

  // this argument , construtor, scope

  //调试必须会
  
  /*function extend(newObj, oldObj) {
    for(let item in oldObj){
      newObj[item] = oldObj[item]
    }
    return newObj
  }
  var result = extend({},{a:2})
  console.log(result);
  // console.log(Global);*/

    /**2018年5月8日18:07:33
     * 第五章：变量的解构赋值
     * undefined在JSON字面量里面不可用；
     * underscore js/Lodash
     * 声明：var,let,const,function,symbal,class
     * 赋值：=
     *
     * const a;//会报错，因为声明必须初始化；
     *
     * 结构变量 var,let,const声明必须初始化；
     *
     * 解构赋值表达式的值是右边的值；
     *
     *
     * 赋值表达式
     * 解构赋值表达式：对象、数组
     */

    /*let a;
    let b = null;
    console.log(a);
    console.log(a__proto__);//报错
    console.log(b__proto__);//报错*/

    // let {type,name} = null //报错
    // console.log(type);
    // console.log(name);
  /*let {type:type} = obj;
  冒号后面才是变量名称*/
  /*let {type:aa} = {type:1}
  console.log(aa);*/ //1

    /*let {a:b} = {a:1};
    console.log(b);*/

/*
...表示不定元素

两种用户：
1.等号右边：
let t = {
  a:1,
  ...obj
}
2.等号左边：
let {...obj} = {
  a:1,
  b:2
}
* */

    /**第六章：符号与符号属性
     * 2018年6月1日09:33:49
     */
    // console.dir(Symbol);
// console.dir(typeof Symbol);//function
/*let firstName = Symbol("description");
let obj = {a:1};
obj[firstName] = 'nikeName';
console.dir(obj);
console.dir(obj[firstName]);
console.log(firstName);
console.log(typeof firstName);
for(var item in obj){
    console.log(item);//用for...in不能遍历出符号
}*/

/*let firstName = Symbol('first name');
console.log(firstName);
console.log(typeof firstName);
let person = {
    [firstName]:'liming'
}
console.log(person);
function test() {
    
}
console.log(test);
console.dir(Function);
    let s = 'str';
    s.replace({
        [Symbol.replace]: function (value, replace) {
            // return replace
            console.log(value, replace);//value是原始值，replace是需要替换的值
        }
    },'string');*/

/*
*属性为什么不可以枚举
* 元编程是什么
* 泛读
* Xmind
* 划重点
* */
    // 第七章 Set与Map
/*let arr = ['a', 'b'];
let set = new Set([arr]);
console.log(set);
console.log(typeof set);
set.add(1);
set.add(2);
console.log(set.size);
    set.add(2);
    console.log(set.size);
    console.log(set.has(1));
    console.log('delete',set.delete(1));
    console.log(set.has(1));
    console.log(set.size);
    set.clear();
    console.log(set.size);
    set.add('m');
    set.add('n');
    console.log('new set', set);
    set.forEach(function (value, key ,onwerSet) {
        console.log(value, key ,onwerSet);
    })

  let wrap = {
        console(item){
            console.log(item);
        },
        product(val){
            val.forEach(function (value) {
                this.console(value)
            }, this)
        }
  }
wrap.product(set)

  let arr2 = [1,2,3,4,5,5,5,5]
  let set2 = new Set(arr2);
    console.log(set2);
    // let newArr2 = Array.from(set2);
    let newArr2 = [...set2];
    console.log(newArr2);
    console.log(typeof newArr2);*/

// map
/*  let map = new Map();
  map.set('a','aa');
  map.set('b','bb');
  console.log(map);*/

/*let set = new WeakSet();
let obj = {a:1};
set.add(obj);
console.log(set);
obj = null;
console.log(set);*/

/*第七章
 */
/*var arr = [111, 222, 333];
console.log(arr);
for(var i of arr){
    console.log(i);
}
console.log(arr[Symbol.iterator]);
console.log(arr[Symbol.iterator]());

    /!**
     * 是否有默认迭代器
     * @param obj
     * @returns {boolean}
     *!/
    function isIterable(obj) {
    return typeof obj[Symbol.iterator] === 'function';
}
console.log(isIterable(arr));
console.log(isIterable('test'));
console.log(isIterable({}));

console.log(arr.entries());
for(var i of arr.entries()){
    console.log(i);
}
console.log(arr.keys());
console.log(arr.values());*/

    /*/!**
     * 创建迭代器
     * @param items
     * @returns {{next: next}}
     *!/
    function createIterator(items) {
    let i = 0;
    return {
        next:function () {
            let done = (i >= items.length);
            let value = !done ? items[i++] : undefined;
            return {
                done,
                value
            }
        }
    }
}
let iterator = createIterator([11,22,33]);
console.log(iterator.next());
console.log(iterator.next());
console.log(iterator.next());
console.log(iterator.next());*/

    /**
     * 生成器
     */
    /*function *createIterator() {
        yield 1;
        yield 2;
        yield 3;
    }
    let iterator = createIterator();
    console.log(iterator);
    console.log(iterator.next());
    console.log(iterator.next());
    console.log(iterator.next());
    console.log(iterator.next());*/

    /**
     * 生成器
     * @param items
     */
    /*function *createIterator(items) {
        for(let i = 0; i<items.length; i++){
            yield items[i];
        }
    }
    let iterator = createIterator([11,22,33]);
    console.log(iterator);
    console.log(iterator.next());
    console.log(iterator.next());
    console.log(iterator.next());
    console.log(iterator.next());*/
    /*let obj = {
        createIterator : function *(items) {
            for(let i = 0; i<items.length; i++){
                yield items[i];
            }
        }
    };*/
    /*let obj = {
        * createIterator(items) {
            for (let i = 0; i < items.length; i++) {
                yield items[i];
            }
        }
    };*/

    /*let collection = {
        items: [],
        * [Symbol.iterator]() {
            for (let item of this.items) {
                yield item;
            }
        }
    };*/
    /*var begintime_ms = new Date(); //begintime 为开始时间

    setTimeout(function () {
        var endtime_ms = new Date();   // endtime 为结束时间
        console.log(begintime_ms);
        console.log(endtime_ms);
        console.log(endtime_ms - begintime_ms);
    }, 1200)*/


    /*function *fn() {
        let a = yield 1;
        let b = yield 2 + a;
        return b;
    }
    let I = fn();
    console.log(I.next());
    console.log(I.next(7));
    console.log(I.next(3));*/

    /**
     *第九章：JS中的类
     */

    /**
     * ES5 中的仿类结构
     * @param name
     * @constructor
     */
    /*function PersonType(name) {
        this.name = name;
    }
    PersonType.prototype.sayName = function () {
        console.log(this.name);
    }
    let person = new PersonType('Nicholas');
    person.sayName();

    console.log(person instanceof PersonType);
    console.log(person instanceof Object);
    console.log(person);
    let aa = new person
    console.log(aa);*/


    /*class PersonClass{
        constructor(name){
            this.name = name;
        }
        sayName(){
            console.log(this.name);
        }
    }
    let person = new PersonClass('Nicholas');
    person.sayName();
    console.log(typeof PersonClass);//function
    console.log(typeof PersonClass.prototype.sayName);//function*/

    /*let PersonClass = class {
        constructor(name){
            this.name = name;
        }
        sayName(){
            console.log(this.name);
        }
    }
    let person = new PersonClass('Nicholas');
    person.sayName();
    console.log(typeof PersonClass);//function
    console.log(typeof PersonClass.prototype.sayName);//function*/

    /*let PersonClass = class PersonClass2 {
        constructor(name){
            this.name = name;
        }
        sayName(){
            console.log(this.name);
        }
    }
    let person = new PersonClass('Nicholas');
    person.sayName();
    console.log(typeof PersonClass);//function
    console.log(typeof PersonClass2);//undefined*/

    /*class CustomHTMLElement{
        constructor(element){
            this.element = element;
        }
        get htmlFun(){
            return this.element.innerHTML;
        }
        set htmlFun(value){
            return this.element = value;
        }
    }
    let descriptor = Object.getOwnPropertyDescriptor(CustomHTMLElement.prototype, 'htmlFun');
    console.log(descriptor);
    console.log('get' in descriptor);//true
    console.log('set' in descriptor);//true
    console.log(descriptor.enumerable);//false*/
    
    //第十一章 Promise与异步编程
    
    /*let promise = new Promise(function (resolve, reject) {
        //resolve();
        //reject();
    });*/

    // let promise = Promise.reject(10);

  //第十二章 代理与反射接口
    //



    //创建一个简单的代理
  /*let target = {};
  let proxy = new Proxy(target, {});
  
  proxy.name = 'proxy';
  console.log(proxy);
  console.log(target);

  target.name = 'target'
    console.log(proxy);
    console.log(target);*/

  //使用 set 陷阱函数验证属性值
    /*let target = {
        name: 'target'
    };
    // console.log(target.hasOwnProperty('name'));
    let proxy = new Proxy(target, {
        set(tarpTarget, key, value, receiver){
            console.log(tarpTarget, key, value, receiver);
            if(!tarpTarget.hasOwnProperty(key)){
                if(isNaN(value)){
                    throw new Error(`${value}必须是数字类型`)
                }
            }
            return Reflect.set(tarpTarget, key, value, receiver);
        }
    });
    proxy.name = 12;
    console.log(target);
    console.log(proxy);

    proxy.newName = 24;
    console.log(target);
    console.log(proxy);


    proxy.newStr = 'newStr';
    console.log(target);
    console.log(proxy);*/

    // get
    /*let target = {};
    let proxy = new Proxy(target, {
        get(tarpTarget, key, receiver){
            if(!(key in receiver)){
                throw new Error(`不存在${key}属性`);
            }
            return Reflect.get(tarpTarget, key, receiver);
        }
    });
    console.log(target);
    console.log(proxy);
    target.name = 1;
    console.log(target);
    console.log(proxy);
    console.log(proxy.name);
    console.log(proxy.names);//报错*/

    // has
    /*let target = {
        name:'target',
        value: 42
    };
    let proxy = new Proxy(target, {
        has(tarpTarget, key){
            if(key == 'name'){
                return false;
            }else {
                return Reflect.has(tarpTarget, key);
            }
        }
    });
    console.log('name' in proxy);
    console.log('names' in proxy);
    console.log('value' in proxy);
    console.log(proxy);
    console.log(target);*/

    //deleteProtory
    // "use strict"
    /*let target = {
        name:'target',
        value: 42
    };
    Object.defineProperty(target, 'name', { configurable: false });
    console.log(target);
    console.log('value' in target);
    var result = delete target.value;
    console.log(result);
    console.log(target);
    var result2 = delete target.name;
    console.log(result2);
    console.log(target);*/

    /*let target = {
        name:'target',
        value: 42
    };
    let proxy = new Proxy(target, {
        deleteProperty(tarpTarget, key){
            if(key === 'name'){

            }
        }
    });*/
    
    

    //复习总结
    //https://docs.qq.com/doc/BqI21X2yZIht1JdRz31dCmBR1R2atZ1eDUOW2zOp9Y3KIPsh0aP4hv0R4yig3YwW464XwsRF0QexQ74r7Hlt0
    //https://docs.qq.com/doc/BqI21X2yZIht1JdRz31dCmBR1NQhze4l3qc61zvCM02Ka7EF0IQmKC2Cjyb92q8GxK3ofKpr0b3rsm2szLt70

    /*function *c() {
      
    }
    let a = c();
    
    console.log(a);
    console.log(a.next);
    console.log(typeof a);


    // let b = 10; for( let t of b) { console.log(t) }

    function * gen(a){ yield 3; let t = yield 4; yield t }; let g = gen();
    console.log(g.next(1));
    console.log(g.next(2));
    console.log(g.next(6));
    
    let aa = new Set([undefined,3, null]);
    console.log(aa);

    let arr1 = new Array(1,2);
    let arr2 = new Array(10);
    console.log(arr1.length);
    console.log(arr2.length);
    
    
    let cc = Array.from(1,2,3);
    console.log(cc);*/
</script>
</body>
</html>